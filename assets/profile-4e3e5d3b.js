import{d as R,a5 as q,u as F,r as c,s as H,ab as J,o as h,c as w,a as e,b as o,w as n,h as d,t as u,e as y,D as K,ac as L,M as Q,ad as W,I as i,f as p,k as g,ae as S,af as X}from"./index-338f6742.js";import{u as Y}from"./useLoading-d20fdbfd.js";import{C as Z}from"./clipboard-f43a2bdf.js";const ee={class:"mt-[20px]"},te={class:"grid-cols-1 xl:grid-cols-2 grid gap-[20px]"},se={class:"shadow-md bg-white rounded-md border p-[15px]"},oe=e("div",{class:"font-bold text-lg border-b pb-[10px]"},"更改密码",-1),ae={class:"mt-[15px]"},le={class:"shadow-md bg-white rounded-md border p-[15px]"},ne=e("div",{class:"font-bold text-lg border-b pb-[10px]"},"通知设置",-1),de=e("div",{class:"bg-[#dcdee4] py-[10px] px-[15px] text-[13px] rounded-md mt-[15px]"}," 我们建议您将我们的站务邮箱加入白名单，避免造成通知邮件进入垃圾桶的情况。 ",-1),ie={class:"mt-[15px]"},re=K('<div class="grid grid-cols-2 py-[20px] px-[15px] bg-[#f9fafd]"><div class="text-[#677789] text-[12px] flex items-center">通知类型</div><div class="flex flex-col items-center justify-center"><div class="w-[25px] h-[25px]"><img src="data:image/svg+xml,%3csvg%20width=&#39;301&#39;%20height=&#39;249&#39;%20viewBox=&#39;0%200%20301%20249&#39;%20fill=&#39;none&#39;%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%3e%3cpath%20d=&#39;M183.077%20221.502C175.986%20228.6%20169.874%20234.718%20165.664%20238.933C154.687%20249.921%20143.16%20243.511%20138.769%20238.933L68.7405%20171.48C58.4021%20161.87%2049.6636%20152.384%2010.5867%20115.115C6.58668%20111.111%200.24822%20100.885%206.89437%2092.0148C13.5405%2083.1443%2050.8944%2036.5741%2068.7405%2014.3977C74.1538%206.55772%2085.9176%20-2.76995%20100.923%2011.1778C113.846%2023.19%20158.154%2064.7706%20196%2096.384&#39;%20stroke=&#39;%2321325B&#39;%20stroke-width=&#39;7&#39;%20stroke-linecap=&#39;round&#39;/%3e%3cpath%20d=&#39;M68%2016C70.2041%2056.4274%2085.0773%20121.507%20162%20146&#39;%20stroke=&#39;%2321325B&#39;%20stroke-width=&#39;7&#39;%20stroke-linecap=&#39;round&#39;/%3e%3cpath%20d=&#39;M265.673%20137.027C264.878%20141.692%20264.068%20143.655%20263.427%20149.46M297%20195.08C293.995%20204.139%20274.455%20223.485%20238.392%20222.991C202.33%20222.497%20191.277%20190.841%20190.127%20176.101C189.076%20162.627%20194.324%20136.653%20213.511%20120.432C232.846%20104.085%20257.407%20103.629%20279.197%20120.432C297.244%20134.349%20297.228%20155.636%20294.008%20166.753C292.093%20173.365%20284.863%20179.847%20271.469%20187.753C264.795%20191.692%20262.426%20183.527%20262.182%20171.694M263.427%20149.46C259.893%20140.525%20232.769%20130.124%20222.526%20149.46C211.962%20169.403%20220.032%20186.204%20226.901%20189.498C235.674%20193.705%20248.57%20195.905%20262.182%20171.694M263.427%20149.46C262.592%20157.022%20262.042%20164.954%20262.182%20171.694&#39;%20stroke=&#39;%2321325B&#39;%20stroke-width=&#39;7&#39;%20stroke-linecap=&#39;round&#39;/%3e%3c/svg%3e" class="w-full h-full"></div><div class="text-[#677789] text-[12px]">EMAIL</div></div></div>',1),ce={class:"grid grid-cols-2 p-[15px] border-b"},_e=e("div",{class:"text-[#677789]"},"到期邮件提醒",-1),pe={class:"flex flex-col items-center justify-center"},ue={class:"grid grid-cols-2 p-[15px] border-b"},fe=e("div",{class:"text-[#677789]"},"流量邮件提醒",-1),me={class:"flex flex-col items-center justify-center"},ve={class:"shadow-md bg-white rounded-md border p-[15px]"},xe=e("div",{class:"font-bold text-lg border-b pb-[10px]"},"重置订阅信息",-1),he=e("div",{class:"text-[#677789] mt-[20px]"}," 当你的订阅地址或账户发生泄漏被他人滥用时，可以在此重置订阅信息。避免带来不必要的损失。 ",-1),we={class:"mt-[15px] flex justify-end"},ge=e("i",{class:"iconfont icon-zhongzhi- text-[#fff]"},null,-1),be=e("div",{class:"ml-2"},"重置订阅",-1),ke={key:0,class:"shadow-md bg-white rounded-md border p-[15px]"},Ce=e("div",{class:"font-bold text-lg border-b pb-[10px]"},"Telegram",-1),ye={class:"mt-[15px]"},Ue={key:0,class:"flex items-center justify-between border-b pb-[15px]"},Be={class:"flex flex-1 overflow-hidden"},Me=e("div",{class:"mr-5"},[e("i",{class:"iconfont icon-jiqiren text-[#677789] text-2xl"})],-1),Te=e("div",{class:"font-bold text-lg"},"绑定 Telegram",-1),je=["href"],Ae={class:"text-theme mt-[5px]"},Le={class:"flex-shrink-0"},Se={key:1,class:"flex items-center border-b py-[15px]"},$e={class:"flex flex-1 overflow-hidden"},Ie=e("div",{class:"mr-5"},[e("i",{class:"iconfont icon-telegram text-[#677789] text-2xl"})],-1),Ne=e("div",{class:"font-bold text-lg"},"Telegram 讨论群",-1),Ve=["href"],De={class:"flex-shrink-0"},ze={class:"flex items-center"},Ee=e("div",{class:"ml-3 text-xl font-bold"},"第一步",-1),Ge={class:"flex items-center mt-4 ml-8"},Oe=e("div",{class:"text-[#677789]"},"打开 Telegram 搜索",-1),Pe=["href"],Re={class:"text-theme ml-3"},qe={class:"flex items-center mt-7"},Fe=e("div",{class:"ml-3 text-xl font-bold"},"第二步",-1),He={class:"mt-4 ml-8"},Je=e("div",{class:"text-[#677789]"},"向机器人发送",-1),Ke=e("span",{class:"text-[#677789] ml-2"},u("<-点击复制"),-1),Ze=R({__name:"profile",setup(Qe){const a=q({old_password:"",_new_password:"",new_password:""}),$=F(),b=c(!1),{getUserInfo:U,getCommConfig:r,getUser:B,getConfig:I}=H($),M=c(window.location.origin),T=c(U.value.remind_expire==1),j=c(U.value.remind_traffic==1),f=c(!1),m=c(!1),{setLoading:k}=Y();async function N(s){try{f.value=!0,await L({remind_expire:s?1:0}),f.value=!1}catch{f.value=!1}}function V(){const s=new Z(".copy",{text:function(){return`/bind  ${M.value}/base/client/subscribe?token=${B.value.token}`}});s.on("success",()=>{i.success("复制成功"),s.destroy()}),s.on("error",()=>{i.error("复制失败,请手动复制"),s.destroy()})}async function D(s){try{m.value=!0,await L({remind_traffic:s?1:0}),m.value=!1}catch{m.value=!1}}const _=c("");r.value.is_telegram==1&&J().then(s=>{_.value=s.data.username});function z(s){window.open(s)}async function E(){Q.confirm({title:"确定要重置订阅信息？",content:"如果您的订阅地址或信息发生泄露可以执行此操作。重置后您的 UUID 及订阅将会变更，需要重新导入订阅。",onOk:async()=>{try{await W(),i.success("重置成功"),window.location.href="#/dashboard"}catch(s){console.log(s)}}})}async function G(){if(!a.old_password)return i.error("请输入当前密码");if(!a.new_password)return i.error("请输入新密码");if(!a._new_password)return i.error("请输入重复新密码");if(a.new_password!==a._new_password)return i.error("两次密码不一致");try{k(!0),await X(a),k(!1),i.success("修改成功")}catch(s){k(!1),console.log(s)}}return(s,t)=>{const C=p("a-input-password"),v=p("a-form-item"),x=p("a-button"),O=p("a-form"),A=p("a-switch"),P=p("a-modal");return h(),w("div",ee,[e("div",te,[e("div",se,[oe,e("div",ae,[o(O,{model:a,name:"basic","label-col":{span:5},"wrapper-col":{span:19},autocomplete:"off",layout:"vertical"},{default:n(()=>[o(v,{label:"当前密码",name:"old_password"},{default:n(()=>[o(C,{value:a.old_password,"onUpdate:value":t[0]||(t[0]=l=>a.old_password=l)},null,8,["value"])]),_:1}),o(v,{label:"新密码",name:"new_password"},{default:n(()=>[o(C,{value:a._new_password,"onUpdate:value":t[1]||(t[1]=l=>a._new_password=l)},null,8,["value"])]),_:1}),o(v,{label:"重复新密码",name:"_new_password"},{default:n(()=>[o(C,{value:a._new_password,"onUpdate:value":t[2]||(t[2]=l=>a._new_password=l)},null,8,["value"])]),_:1}),o(v,{"wrapper-col":{offset:0}},{default:n(()=>[o(x,{type:"primary","html-type":"submit",class:"w-full sm:w-auto",onClick:G},{default:n(()=>[g("确定修改 ")]),_:1})]),_:1})]),_:1},8,["model"])])]),e("div",le,[ne,de,e("div",ie,[re,e("div",ce,[_e,e("div",pe,[o(A,{checked:T.value,"onUpdate:checked":t[3]||(t[3]=l=>T.value=l),loading:f.value,onChange:N},null,8,["checked","loading"])])]),e("div",ue,[fe,e("div",me,[o(A,{checked:j.value,"onUpdate:checked":t[4]||(t[4]=l=>j.value=l),loading:m.value,onChange:D},null,8,["checked","loading"])])])])]),e("div",ve,[xe,he,e("div",we,[o(x,{type:"primary",danger:"",onClick:E},{icon:n(()=>[ge]),default:n(()=>[be]),_:1})])]),d(r).is_telegram==1||d(r).telegram_discuss_link?(h(),w("div",ke,[Ce,e("div",ye,[d(r).is_telegram==1&&_.value&&d(I).app_url?(h(),w("div",Ue,[e("div",Be,[Me,e("div",null,[Te,e("a",{href:`https://t.me/${_.value}`,target:"_blank"},[e("div",Ae,"@"+u(_.value),1)],8,je)])]),e("div",Le,[o(x,{onClick:t[5]||(t[5]=l=>b.value=!0)},{default:n(()=>[g("开始绑定")]),_:1})])])):y("",!0),d(r).telegram_discuss_link?(h(),w("div",Se,[e("div",$e,[Ie,e("div",null,[Ne,e("a",{href:d(r).telegram_discuss_link,target:"_blank",class:"text-theme mt-[5px]"}," 点击加入Telegram 讨论群 ",8,Ve)])]),e("div",De,[o(x,{onClick:t[6]||(t[6]=l=>z(d(r).telegram_discuss_link))},{default:n(()=>[g("加入群组")]),_:1})])])):y("",!0)])])):y("",!0)]),e("div",null,[o(P,{open:b.value,"onUpdate:open":t[7]||(t[7]=l=>b.value=l),title:"绑定TG Bot",footer:null},{default:n(()=>[e("div",null,[e("div",ze,[o(d(S),{class:"text-theme text-xl"}),Ee]),e("div",Ge,[Oe,e("a",{href:`https://t.me/${_.value}`,target:"_blank"},[e("div",Re,"@"+u(_.value),1)],8,Pe)]),e("div",qe,[o(d(S),{class:"text-theme text-xl"}),Fe]),e("div",He,[Je,e("div",{class:"mt-2 text-[#d73384] copy",onClick:V},[g(" /bind "+u(M.value)+"/base/client/subscribe?token="+u(d(B).token)+" ",1),Ke])])])]),_:1},8,["open"])])])}}});export{Ze as default};
